{"ast":null,"code":"var _jsxFileName = \"/Users/keremguventurk/Desktop/northwestern/winter2020/bme390-2/Self-Service-Database-UI/src/views/PatientHistoryPage.jsx\";\nimport React, { Component } from \"react\";\nimport { Grid, Row, Col, DropdownButton, Pagination } from \"react-bootstrap\";\nimport CustomButton from \"components/CustomButton/CustomButton\";\nimport TableList from \"./TableList.jsx\";\nimport { apiBaseURL } from \"./Dashboard.jsx\";\n\nconst axios = require(\"axios\");\n/* const filter_categories = [\n    \"Date\",\n    \"Eye Diagnosis\",\n    \"Systemic Diagnosis\",\n    \"Age\",\n    \"Ethnicity\",\n    \"Image Procedure Type\",\n    \"Labs\",\n    \"Medication Generic Name\",\n    \"Medication Therapuetic Name\",\n    \"Vision\",\n    \"Pressure\",\n    \"Exam ID\"\n  ]; */\n//PatientHistorypage displays individual patient history information\n//Feb. 4, 2020 fixed bug for website crashing when clicking on patient ID number\n\n\nconst filter_categories = [\"Date\", \"Eye Diagnosis\", \"Systemic Diagnosis\", \"Labs\", \"Medication Generic Name\", \"Medication Therapuetic Name\", \"Vision\", \"Pressure\", \"Exam ID\"];\nconst frontendToBackend = {\n  \"Eye Diagnosis\": \"eye_diagnosis\",\n  \"Systemic Diagnosis\": \"systemic_diagnosis\",\n  Age: \"age\",\n  Ethnicity: \"ethnicity\",\n  \"Image Procedure Type\": \"image_type\",\n  Labs: \"lab_values\",\n  \"Medication Generic Name\": \"medication_generic_name\",\n  \"Medication Therapuetic Name\": \"medication_therapuetic_name\",\n  \"Left Vision\": \"left_vision\",\n  \"Right Vision\": \"right_vision\",\n  \"Left Pressure\": \"left_pressure\",\n  \"Right Pressure\": \"right_pressure\",\n  Date: \"date\",\n  \"Exam ID\": \"exam_id\"\n}; //purpose is to convert the capitalization and underlines between the frontend and backend\n\nconst backendToFrontend = {};\n\nfor (let key in frontendToBackend) {\n  backendToFrontend[frontendToBackend[key]] = key;\n}\n\nfunction isDict(v) {\n  return typeof v === \"object\" && v !== null && !(v instanceof Array) && !(v instanceof Date);\n} //function compareDates compares dates a and b\n//returns true if date a is later than b, false otherwise\n//dates are in the format of \"Thu, 09 Aug 2018\" without the quotes\n\n\nfunction compareDates(a, b) {\n  let year_a = parseInt(a.substring(12, 16));\n  let month_a = a.substring(8, 11);\n  let day_a = parseInt(a.substring(5, 7));\n  let year_b = parseInt(b.substring(12, 16));\n  let month_b = b.substring(8, 11);\n  let day_b = parseInt(b.substring(5, 7));\n  const months = {\n    Jan: 0,\n    Feb: 1,\n    Mar: 2,\n    Apr: 3,\n    May: 4,\n    Jun: 5,\n    Jul: 6,\n    Aug: 7,\n    Sep: 8,\n    Oct: 9,\n    Nov: 10,\n    Dec: 11\n  };\n\n  if (year_a !== year_b) {\n    return year_a - year_b;\n  }\n\n  if (months[month_a] !== months[month_b]) {\n    return months[month_a] - months[month_b];\n  }\n\n  if (day_a !== day_b) {\n    return day_a - day_b;\n  }\n\n  return 0;\n} //Variables:\n//patientID: The relevant patient ID whose patient history is dislpayed\n//filterCategories\n//selectedFilterCategories\n//tableKey\n//exportPressed\n\n\nclass PatientHistoryPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      patientID: null,\n      filterCategories: filter_categories,\n      selectedFilterCategories: filter_categories,\n      tableKey: 1,\n      exportPressed: {\n        display: false\n      },\n      paginationNumber: 1\n    };\n    this.getData = this.getData.bind(this);\n    this.editData = this.editData.bind(this);\n    this.getFilters = this.getFilters.bind(this);\n    this.categoryFilterPressed = this.categoryFilterPressed.bind(this);\n    this.getTables = this.getTables.bind(this);\n    this.getSummaryTable = this.getSummaryTable.bind(this);\n    this.backButtonPressed = this.backButtonPressed.bind(this);\n    this.imagesButtonPressed = this.imagesButtonPressed.bind(this);\n    this.paginationClicked = this.paginationClicked.bind(this);\n    this.getPagination = this.getPagination.bind(this);\n  }\n\n  componentDidMount() {\n    if (!this.props.pageStatus.PatientHistoryPage) {\n      return;\n    }\n\n    this.setState({\n      patientID: this.props.pageStatus.PatientHistoryPage.patientID\n    }, () => this.getData());\n  } //sets the state of patientinfo to be the one for the relevant patient ID\n\n\n  getData() {\n    let currentComponent = this;\n    let patientID = this.state.patientID;\n    let link = apiBaseURL + \"/ssd_api/patients?pt_id=\" + patientID;\n    var autToken = \"Basic \" + btoa(this.props.accessToken + \":something\");\n    const options = {\n      url: link,\n      method: 'get',\n      headers: {\n        'Authorization': autToken\n      }\n    };\n    axios(options).then(function (response) {\n      let patientInfo = response.data.result[patientID];\n      currentComponent.setState({\n        patientInfo: patientInfo\n      }, () => {\n        currentComponent.editData();\n      });\n    }).catch(function (error) {\n      console.log(error);\n\n      if (error.message === \"Request failed with status code 401\") {\n        currentComponent.props.backToLoginPage();\n      }\n    });\n  } //sets up the patient info to populate the table on the website\n\n\n  editData() {\n    if (!this.state.patientInfo) {\n      //if patient info is nonexistent, then cannot edit patient info, so return\n      return;\n    }\n\n    let patientInfo = {};\n    let date = [];\n    let category = null;\n\n    for (let key in this.state.patientInfo) {\n      if (key === \"eye_diagnosis\" || key === \"systemic_diagnosis\") {\n        for (let key2 in this.state.patientInfo[key]) {\n          if (this.state.patientInfo[key][key2] !== null) {\n            date = this.state.patientInfo[key][key2].substring(0, 16);\n            patientInfo[date] = {};\n          }\n        }\n      } else if (typeof this.state.patientInfo[key] === \"object\") {\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (isDict(this.state.patientInfo[key][i]) && this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            patientInfo[date] = {};\n          }\n        }\n      }\n    }\n\n    for (let key in this.state.patientInfo) {\n      if (key === \"eye_diagnosis\" || key === \"systemic_diagnosis\") {\n        for (let key2 in this.state.patientInfo[key]) {\n          if (this.state.patientInfo[key][key2] != null) {\n            date = this.state.patientInfo[key][key2].substring(0, 16);\n\n            if (patientInfo[date]) {\n              patientInfo[date][backendToFrontend[key]] = key2;\n            }\n          }\n        }\n      } else if (key === \"vision\" || key === \"pressure\") {\n        let category1 = null;\n        let category2 = null;\n\n        if (key === \"vision\") {\n          category1 = \"Left Vision\";\n          category2 = \"Right Vision\";\n        } else {\n          category1 = \"Left Pressure\";\n          category2 = \"Right Pressure\";\n        }\n\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            category = category2;\n\n            if (this.state.patientInfo[key][i].name.search(\"LEFT\") !== -1) {\n              category = category1;\n            }\n\n            patientInfo[date][category] = this.state.patientInfo[key][i].value;\n          }\n        }\n      } else if (key === \"lab_values\") {\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            category = backendToFrontend[key];\n            patientInfo[date][category] = {\n              \"Lab Name\": this.state.patientInfo[key][i].lab_name,\n              \"Lab Value\": this.state.patientInfo[key][i].lab_value\n            };\n          }\n        }\n      } else if (key === \"medication\") {\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            patientInfo[date][\"Medication Generic Name\"] = this.state.patientInfo[key][i].generic_name;\n            patientInfo[date][\"Medication Therapeutic Name\"] = this.state.patientInfo[key][i].therapeutic_class;\n          }\n        }\n      }\n    }\n\n    this.setState({\n      patientInfo: patientInfo,\n      loaded: \"true\"\n    });\n  } //uses this.state.filterCategories, containing a list of fitler category names, then recreates a list\n  //with CustomButton elements that is returned as temp_filter_categories\n\n\n  getFilters() {\n    let filter_categories = this.state.filterCategories;\n    let temp_filter_categories = [];\n\n    for (let i = 0; i < filter_categories.length; i++) {\n      let category_name = filter_categories[i];\n\n      if (category_name === \"Date\") {\n        continue;\n      }\n\n      let temp_filter_category = null;\n\n      if (this.state.selectedFilterCategories.indexOf(category_name) !== -1) {\n        temp_filter_category = React.createElement(CustomButton, {\n          style: styles.buttonDivPressed,\n          title: category_name,\n          onClick: e => this.categoryFilterPressed(e),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 286\n          },\n          __self: this\n        }, \" \", category_name, \" \");\n      } else {\n        temp_filter_category = React.createElement(CustomButton, {\n          style: styles.buttonDiv,\n          title: category_name,\n          onClick: e => this.categoryFilterPressed(e),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 297\n          },\n          __self: this\n        }, \" \", category_name, \" \");\n      }\n\n      temp_filter_categories.push(temp_filter_category);\n    }\n\n    return temp_filter_categories;\n  } //If the category filter is pressed, update the state of selectedFilterCategories to what is newly selected\n\n\n  categoryFilterPressed(e) {\n    let category = e.target.title;\n\n    if (category === \"Date\") {\n      return;\n    }\n\n    if (this.state.selectedFilterCategories.indexOf(category) === -1) {\n      this.state.selectedFilterCategories.push(category);\n      this.setState({\n        selectedFilterCategories: this.state.selectedFilterCategories,\n        tableKey: this.state.tableKey + 1\n      });\n    } else {\n      let new_list = this.state.selectedFilterCategories.filter(function (name) {\n        return name !== category;\n      });\n      this.setState({\n        selectedFilterCategories: new_list,\n        tableKey: this.state.tableKey + 1\n      });\n    }\n  } //return tablelist object\n  //If a category exists in the selectedFilterCategories list, then push it into a variable called selectedCategories\n  //Exception for vision and pressure, have both left and right addded to the category.\n\n\n  getTables() {\n    var nullTable = React.createElement(Col, {\n      style: styles.titleText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, \" You Have Not Selected A Patent  \"));\n\n    if (!this.state.loaded || !this.state.patientInfo) {\n      return [nullTable, null];\n    }\n\n    let selectedCategories = [];\n\n    for (let i = 0; i < this.state.filterCategories.length; i++) {\n      let category = this.state.filterCategories[i];\n\n      if (this.state.selectedFilterCategories.indexOf(category) !== -1) {\n        if (category === \"Vision\" || category === \"Pressure\") {\n          selectedCategories.push(\"Left \" + category);\n          selectedCategories.push(\"Right \" + category);\n        } else {\n          selectedCategories.push(category);\n        }\n      }\n    }\n\n    let patientInfo = this.state.patientInfo;\n    let tableData = [];\n\n    for (let date in patientInfo) {\n      let data = patientInfo[date];\n      let tempDateData = [];\n      let isEmpty = true;\n\n      if (selectedCategories.indexOf(\"Date\") !== -1) {\n        tempDateData = [{\n          type: \"string\",\n          text: date\n        }];\n      }\n\n      for (let ii = 1; ii < selectedCategories.length; ii++) {\n        let category = selectedCategories[ii];\n        let value = {\n          type: \"string\",\n          text: \"\"\n        };\n        let tempValue = data[category];\n\n        if (!tempValue) {\n          tempDateData.push(value);\n        } else {\n          isEmpty = false;\n          let text = [];\n\n          if (category === \"Date\") {\n            continue;\n          } else if (category === \"Labs\") {\n            for (let labName in tempValue) {\n              let labValue = tempValue[labName];\n\n              if (labName && labValue) {\n                text.push(labName + \": \" + labValue);\n                text.push(React.createElement(\"br\", {\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 396\n                  },\n                  __self: this\n                }));\n              } else if (labName) {\n                text.push(labName + \": undefined\");\n                text.push(React.createElement(\"br\", {\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 399\n                  },\n                  __self: this\n                }));\n              }\n            }\n          } else {\n            text = tempValue;\n          }\n\n          value[\"text\"] = text;\n          tempDateData.push(value);\n        }\n      }\n\n      if (!isEmpty) {\n        tableData.push(tempDateData);\n      }\n    }\n\n    tableData.sort((a, b) => compareDates(b[0].text, a[0].text));\n    var tempTableData = [];\n\n    for (var i = (this.state.paginationNumber - 1) * 5; i < Math.min(this.state.paginationNumber * 5, tableData.length); i++) {\n      tempTableData.push(tableData[i]);\n    }\n\n    return [React.createElement(TableList, {\n      key: this.state.tableKey,\n      columns: selectedCategories,\n      rows: tempTableData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420\n      },\n      __self: this\n    }), this.getSummaryTable(tableData[0])];\n  } //used in the getTable() function\n  //returns TableList object\n\n\n  getSummaryTable(patientData) {\n    if (!(patientData && patientData[0])) {\n      return null;\n    }\n\n    const selectedCategories = [\"Date\", \"Eye Diagnosis\", \"Systemic Diagnosis\", \"Age\", \"Ethnicity\", \"Image Procedure Type\", \"Labs\", \"Medication Generic Name\", \"Medication Therapuetic Name\", \"Left Vision\", \"Right Vision\", \"Left Pressure\", \"Right Pressure\", \"Exam ID\"];\n    let date = patientData[0].text;\n    patientData = this.state.patientInfo[date];\n    let patientInfo = this.props.pageStatus.PatientHistoryPage.patientInfo;\n    patientData[\"Ethnicity\"] = patientInfo.ethnicity;\n    patientData[\"Image Procedure Type\"] = patientInfo.image_type;\n    patientData[\"Age\"] = patientInfo.age;\n    patientData[\"Date\"] = date;\n    let tableData = [];\n    let tempDateData = [];\n\n    for (let i = 0; i < selectedCategories.length; i++) {\n      let category = selectedCategories[i];\n      let value = {\n        type: \"string\",\n        text: patientData[category]\n      };\n      let tempText = [];\n\n      if (typeof patientData[category] === \"object\") {\n        for (let j = 0; j < patientData[category].length; j++) {\n          tempText.push(patientData[category][j]);\n          tempText.push(React.createElement(\"br\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 475\n            },\n            __self: this\n          }));\n        }\n\n        value[\"text\"] = tempText;\n      }\n\n      tempDateData.push(value);\n    }\n\n    tableData = [tempDateData];\n    return React.createElement(TableList, {\n      columns: selectedCategories,\n      rows: tableData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 483\n      },\n      __self: this\n    });\n  } //Change page to patients page, with additionalInfo serving as the \"memory\" to retain entered filter information\n\n\n  backButtonPressed() {\n    let newState = {\n      page: \"PatientsPage\"\n    };\n    this.props.changePage(newState);\n  } //To be filled after images are set up\n\n\n  imagesButtonPressed() {\n    let tempPageStatus = this.props.pageStatus;\n    tempPageStatus[\"PatientImagesPage\"] = {\n      patientID: this.state.patientID\n    };\n    let newState = {\n      page: \"PatientImagesPage\",\n      pageStatus: tempPageStatus\n    };\n    this.props.changePage(newState);\n  }\n\n  paginationClicked(e) {\n    this.setState({\n      paginationNumber: e.target.title\n    });\n  }\n\n  getPagination() {\n    var pagination = [];\n\n    if (!this.state.patientInfo) {\n      return null;\n    }\n\n    console.log(\"LOOK HERE\", Object.keys(this.state.patientInfo).length);\n\n    for (var number = 0; number < Object.keys(this.state.patientInfo).length / 5; number++) {\n      if (number + 1 === this.state.paginationNumber) {\n        pagination.push(React.createElement(Pagination.Item, {\n          title: number + 1,\n          style: styles.paginationActive,\n          onClick: e => this.paginationClicked(e),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 523\n          },\n          __self: this\n        }, number + 1));\n      } else {\n        pagination.push(React.createElement(Pagination.Item, {\n          title: number + 1,\n          onClick: e => this.paginationClicked(e),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 530\n          },\n          __self: this\n        }, number + 1));\n      }\n    }\n\n    return React.createElement(Pagination, {\n      style: styles.paginationStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 536\n      },\n      __self: this\n    }, pagination);\n  } //render is what shows on the webpage\n\n\n  render() {\n    let all_filters = this.getFilters();\n    let tables = this.getTables();\n    let table = null;\n    let summaryTable = null;\n    var pagination = this.getPagination();\n\n    if (tables) {\n      table = tables[0];\n      summaryTable = tables[1];\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 551\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 552\n      },\n      __self: this\n    }, React.createElement(Row, {\n      style: styles.titleStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 553\n      },\n      __self: this\n    }, React.createElement(Col, {\n      lg: 12,\n      sm: 8,\n      style: styles.titleText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 554\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 555\n      },\n      __self: this\n    }, \"Individual Patient History ID: \", this.state.patientID))), React.createElement(Row, {\n      style: styles.summaryStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 558\n      },\n      __self: this\n    }, React.createElement(Col, {\n      style: styles.summaryText,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 559\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: styles.underMainStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 560\n      },\n      __self: this\n    }, React.createElement(DropdownButton, {\n      style: styles.buttonContainer,\n      title: \"TAKE AN ACTION\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 561\n      },\n      __self: this\n    }, React.createElement(CustomButton, {\n      style: styles.buttonUpperBack,\n      onClick: () => this.backButtonPressed(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 562\n      },\n      __self: this\n    }, \"BACK TO PATIENTS PAGE\"), React.createElement(CustomButton, {\n      style: styles.buttonUpperImages,\n      onClick: () => this.imagesButtonPressed(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 568\n      },\n      __self: this\n    }, \"SEE ALL PATIENTS IMAGES\"))))), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 578\n      },\n      __self: this\n    }, React.createElement(Col, {\n      sm: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 579\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 580\n      },\n      __self: this\n    }, React.createElement(CustomButton, {\n      style: styles.buttonDivShow,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 581\n      },\n      __self: this\n    }, \" \", \"Shown\", \" \"), React.createElement(CustomButton, {\n      style: styles.buttonDivHide,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 585\n      },\n      __self: this\n    }, \" \", \"Hidden\", \" \")), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 590\n      },\n      __self: this\n    }, all_filters)), React.createElement(Col, {\n      sm: 9,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 592\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 593\n      },\n      __self: this\n    }, React.createElement(Row, {\n      style: styles.underTitleStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 594\n      },\n      __self: this\n    }, summaryTable), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 595\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: styles.mainDivStyle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 596\n      },\n      __self: this\n    }, table, pagination)))))));\n  }\n\n}\n\nexport default PatientHistoryPage;\nconst styles = {\n  titleStyle: {\n    height: \"10vh\",\n    \"margin-bottom\": \"2vh\"\n  },\n  titleText: {\n    display: \"flex\",\n    \"align-items\": \"center\",\n    \"justify-content\": \"center\",\n    \"font-weight\": \"bold\",\n    \"font-size\": \"30px\"\n  },\n  buttonDiv: {\n    width: \"100%\",\n    margin: \"1vh\",\n    \"background-color\": \"white\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  buttonDivPressed: {\n    width: \"100%\",\n    margin: \"1vh\",\n    \"background-color\": \"#78deec\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  buttonDivHide: {\n    width: \"45%\",\n    \"margin-top\": \"1vh\",\n    \"margin-bottom\": \"1vh\",\n    \"margin-left\": \"2vh\",\n    \"background-color\": \"white\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  buttonDivShow: {\n    width: \"45%\",\n    margin: \"1vh\",\n    \"background-color\": \"#78deec\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  mainDivStyle: {\n    \"max-height\": \"90vh\",\n    \"max-width\": \"120vh\",\n    overflow: \"scroll\"\n  },\n  underTitleStyle: {\n    \"max-width\": \"120vh\",\n    overflow: \"scroll\",\n    \"margin-top\": \"1vh\"\n  },\n  underMainStyle: {\n    display: \"flex\",\n    \"flex-direction\": \"column\",\n    \"justify-content\": \"flex-end\",\n    \"align-items\": \"flex-end\",\n    \"padding-right\": \"2vh\"\n  },\n  buttonUpperBack: {\n    width: \"40vh\",\n    color: \"black\",\n    border: \"solid 2px black\",\n    \"font-weight\": \"bold\",\n    \"margin-top\": \"1vh\"\n  },\n  buttonContainer: {\n    width: \"40vh\",\n    color: \"black\",\n    border: \"solid 2px black\",\n    \"font-weight\": \"bold\",\n    \"background-color\": \"#eef27c\"\n  },\n  buttonUpperImages: {\n    width: \"40vh\",\n    color: \"black\",\n    border: \"solid 2px black\",\n    \"font-weight\": \"bold\",\n    \"margin-top\": \"1vh\",\n    \"margin-bottom\": \"1vh\"\n  }\n};","map":{"version":3,"sources":["/Users/keremguventurk/Desktop/northwestern/winter2020/bme390-2/Self-Service-Database-UI/src/views/PatientHistoryPage.jsx"],"names":["React","Component","Grid","Row","Col","DropdownButton","Pagination","CustomButton","TableList","apiBaseURL","axios","require","filter_categories","frontendToBackend","Age","Ethnicity","Labs","Date","backendToFrontend","key","isDict","v","Array","compareDates","a","b","year_a","parseInt","substring","month_a","day_a","year_b","month_b","day_b","months","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","PatientHistoryPage","constructor","props","state","patientID","filterCategories","selectedFilterCategories","tableKey","exportPressed","display","paginationNumber","getData","bind","editData","getFilters","categoryFilterPressed","getTables","getSummaryTable","backButtonPressed","imagesButtonPressed","paginationClicked","getPagination","componentDidMount","pageStatus","setState","currentComponent","link","autToken","btoa","accessToken","options","url","method","headers","then","response","patientInfo","data","result","catch","error","console","log","message","backToLoginPage","date","category","key2","i","length","category1","category2","name","search","value","lab_name","lab_value","generic_name","therapeutic_class","loaded","temp_filter_categories","category_name","temp_filter_category","indexOf","styles","buttonDivPressed","e","buttonDiv","push","target","title","new_list","filter","nullTable","titleText","selectedCategories","tableData","tempDateData","isEmpty","type","text","ii","tempValue","labName","labValue","sort","tempTableData","Math","min","patientData","ethnicity","image_type","age","tempText","j","newState","page","changePage","tempPageStatus","pagination","Object","keys","number","paginationActive","paginationStyle","render","all_filters","tables","table","summaryTable","titleStyle","summaryStyle","summaryText","underMainStyle","buttonContainer","buttonUpperBack","buttonUpperImages","buttonDivShow","buttonDivHide","underTitleStyle","mainDivStyle","height","width","margin","color","border","overflow"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Grid, Row, Col, DropdownButton, Pagination } from \"react-bootstrap\";\nimport CustomButton from \"components/CustomButton/CustomButton\";\nimport TableList from \"./TableList.jsx\";\n\nimport { apiBaseURL } from \"./Dashboard.jsx\";\n\nconst axios = require(\"axios\");\n\n/* const filter_categories = [\n    \"Date\",\n    \"Eye Diagnosis\",\n    \"Systemic Diagnosis\",\n    \"Age\",\n    \"Ethnicity\",\n    \"Image Procedure Type\",\n    \"Labs\",\n    \"Medication Generic Name\",\n    \"Medication Therapuetic Name\",\n    \"Vision\",\n    \"Pressure\",\n    \"Exam ID\"\n  ]; */\n\n//PatientHistorypage displays individual patient history information\n//Feb. 4, 2020 fixed bug for website crashing when clicking on patient ID number\nconst filter_categories = [\n  \"Date\",\n  \"Eye Diagnosis\",\n  \"Systemic Diagnosis\",\n  \"Labs\",\n  \"Medication Generic Name\",\n  \"Medication Therapuetic Name\",\n  \"Vision\",\n  \"Pressure\",\n  \"Exam ID\"\n];\n\nconst frontendToBackend = {\n  \"Eye Diagnosis\": \"eye_diagnosis\",\n  \"Systemic Diagnosis\": \"systemic_diagnosis\",\n  Age: \"age\",\n  Ethnicity: \"ethnicity\",\n  \"Image Procedure Type\": \"image_type\",\n  Labs: \"lab_values\",\n  \"Medication Generic Name\": \"medication_generic_name\",\n  \"Medication Therapuetic Name\": \"medication_therapuetic_name\",\n  \"Left Vision\": \"left_vision\",\n  \"Right Vision\": \"right_vision\",\n  \"Left Pressure\": \"left_pressure\",\n  \"Right Pressure\": \"right_pressure\",\n  Date: \"date\",\n  \"Exam ID\": \"exam_id\"\n};\n\n//purpose is to convert the capitalization and underlines between the frontend and backend\nconst backendToFrontend = {};\nfor (let key in frontendToBackend) {\n  backendToFrontend[frontendToBackend[key]] = key;\n}\n\nfunction isDict(v) {\n  return (\n    typeof v === \"object\" &&\n    v !== null &&\n    !(v instanceof Array) &&\n    !(v instanceof Date)\n  );\n}\n\n//function compareDates compares dates a and b\n//returns true if date a is later than b, false otherwise\n//dates are in the format of \"Thu, 09 Aug 2018\" without the quotes\nfunction compareDates(a, b) {\n  let year_a = parseInt(a.substring(12, 16));\n  let month_a = a.substring(8, 11);\n  let day_a = parseInt(a.substring(5, 7));\n\n  let year_b = parseInt(b.substring(12, 16));\n  let month_b = b.substring(8, 11);\n  let day_b = parseInt(b.substring(5, 7));\n\n  const months = {\n    Jan: 0,\n    Feb: 1,\n    Mar: 2,\n    Apr: 3,\n    May: 4,\n    Jun: 5,\n    Jul: 6,\n    Aug: 7,\n    Sep: 8,\n    Oct: 9,\n    Nov: 10,\n    Dec: 11\n  };\n\n  if (year_a !== year_b) {\n    return year_a - year_b;\n  }\n  if (months[month_a] !== months[month_b]) {\n    return months[month_a] - months[month_b];\n  }\n  if (day_a !== day_b) {\n    return day_a - day_b;\n  }\n  return 0;\n}\n\n//Variables:\n//patientID: The relevant patient ID whose patient history is dislpayed\n//filterCategories\n//selectedFilterCategories\n//tableKey\n//exportPressed\nclass PatientHistoryPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      patientID: null,\n      filterCategories: filter_categories,\n      selectedFilterCategories: filter_categories,\n      tableKey: 1,\n      exportPressed: {\n        display: false\n      },\n      paginationNumber: 1\n    };\n    this.getData = this.getData.bind(this);\n    this.editData = this.editData.bind(this);\n    this.getFilters = this.getFilters.bind(this);\n    this.categoryFilterPressed = this.categoryFilterPressed.bind(this);\n    this.getTables = this.getTables.bind(this);\n    this.getSummaryTable = this.getSummaryTable.bind(this);\n    this.backButtonPressed = this.backButtonPressed.bind(this);\n    this.imagesButtonPressed = this.imagesButtonPressed.bind(this);\n    this.paginationClicked = this.paginationClicked.bind(this);\n    this.getPagination = this.getPagination.bind(this);\n  }\n\n  componentDidMount() {\n    if (!this.props.pageStatus.PatientHistoryPage) {\n      return\n    }\n    this.setState(\n      {\n        patientID: this.props.pageStatus.PatientHistoryPage.patientID\n      },\n      () => this.getData()\n    );\n  }\n\n  //sets the state of patientinfo to be the one for the relevant patient ID\n  getData() {\n    let currentComponent = this;\n    let patientID = this.state.patientID;\n    let link = apiBaseURL + \"/ssd_api/patients?pt_id=\" + patientID;\n    var autToken = \"Basic \" + btoa(this.props.accessToken + \":something\")\n\n    const options = {\n      url: link,\n      method: 'get',\n      headers: {\n        'Authorization': autToken\n      },\n    };\n\n    axios(options)\n      .then(function (response) {\n        let patientInfo = response.data.result[patientID];\n        currentComponent.setState({ patientInfo: patientInfo }, () => {\n          currentComponent.editData();\n        });\n      })\n      .catch(function (error) {\n        console.log(error);\n        if (error.message === \"Request failed with status code 401\") {\n          currentComponent.props.backToLoginPage()\n        }\n      });\n  }\n\n  //sets up the patient info to populate the table on the website\n  editData() {\n    if (!this.state.patientInfo) {\n      //if patient info is nonexistent, then cannot edit patient info, so return\n      return;\n    }\n    let patientInfo = {};\n    let date = [];\n    let category = null;\n    for (let key in this.state.patientInfo) {\n      if (key === \"eye_diagnosis\" || key === \"systemic_diagnosis\") {\n        for (let key2 in this.state.patientInfo[key]) {\n          if (this.state.patientInfo[key][key2] !== null) {\n            date = this.state.patientInfo[key][key2].substring(0, 16);\n            patientInfo[date] = {};\n          }\n        }\n      } else if (typeof this.state.patientInfo[key] === \"object\") {\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (\n            isDict(this.state.patientInfo[key][i]) &&\n            this.state.patientInfo[key][i].date\n          ) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            patientInfo[date] = {};\n          }\n        }\n      }\n    }\n    for (let key in this.state.patientInfo) {\n      if (key === \"eye_diagnosis\" || key === \"systemic_diagnosis\") {\n        for (let key2 in this.state.patientInfo[key]) {\n          if (this.state.patientInfo[key][key2] != null) {\n            date = this.state.patientInfo[key][key2].substring(0, 16);\n            if (patientInfo[date]) {\n              patientInfo[date][backendToFrontend[key]] = key2;\n            }\n          }\n        }\n      } else if (key === \"vision\" || key === \"pressure\") {\n        let category1 = null;\n        let category2 = null;\n        if (key === \"vision\") {\n          category1 = \"Left Vision\";\n          category2 = \"Right Vision\";\n        } else {\n          category1 = \"Left Pressure\";\n          category2 = \"Right Pressure\";\n        }\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            category = category2;\n            if (this.state.patientInfo[key][i].name.search(\"LEFT\") !== -1) {\n              category = category1;\n            }\n            patientInfo[date][category] = this.state.patientInfo[key][i].value;\n          }\n        }\n      } else if (key === \"lab_values\") {\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            category = backendToFrontend[key];\n            patientInfo[date][category] = {\n              \"Lab Name\": this.state.patientInfo[key][i].lab_name,\n              \"Lab Value\": this.state.patientInfo[key][i].lab_value\n            };\n          }\n        }\n      } else if (key === \"medication\") {\n        for (let i = 0; i < this.state.patientInfo[key].length; i++) {\n          if (this.state.patientInfo[key][i].date) {\n            date = this.state.patientInfo[key][i].date.substring(0, 16);\n            patientInfo[date][\n              \"Medication Generic Name\"\n            ] = this.state.patientInfo[key][i].generic_name;\n            patientInfo[date][\n              \"Medication Therapeutic Name\"\n            ] = this.state.patientInfo[key][i].therapeutic_class;\n          }\n        }\n      }\n    }\n    this.setState({\n      patientInfo: patientInfo,\n      loaded: \"true\"\n    });\n  }\n\n  //uses this.state.filterCategories, containing a list of fitler category names, then recreates a list\n  //with CustomButton elements that is returned as temp_filter_categories\n  getFilters() {\n    let filter_categories = this.state.filterCategories;\n    let temp_filter_categories = [];\n    for (let i = 0; i < filter_categories.length; i++) {\n      let category_name = filter_categories[i];\n      if (category_name === \"Date\") {\n        continue\n      }\n      let temp_filter_category = null;\n      if (this.state.selectedFilterCategories.indexOf(category_name) !== -1) {\n        temp_filter_category = (\n          <CustomButton\n            style={styles.buttonDivPressed}\n            title={category_name}\n            onClick={e => this.categoryFilterPressed(e)}\n          >\n            {\" \"}\n            {category_name}{\" \"}\n          </CustomButton>\n        );\n      } else {\n        temp_filter_category = (\n          <CustomButton\n            style={styles.buttonDiv}\n            title={category_name}\n            onClick={e => this.categoryFilterPressed(e)}\n          >\n            {\" \"}\n            {category_name}{\" \"}\n          </CustomButton>\n        );\n      }\n      temp_filter_categories.push(temp_filter_category);\n    }\n    return temp_filter_categories;\n  }\n\n  //If the category filter is pressed, update the state of selectedFilterCategories to what is newly selected\n  categoryFilterPressed(e) {\n    let category = e.target.title;\n    if (category === \"Date\") {\n      return;\n    }\n    if (this.state.selectedFilterCategories.indexOf(category) === -1) {\n      this.state.selectedFilterCategories.push(category);\n      this.setState({\n        selectedFilterCategories: this.state.selectedFilterCategories,\n        tableKey: this.state.tableKey + 1\n      });\n    } else {\n      let new_list = this.state.selectedFilterCategories.filter(function (name) {\n        return name !== category;\n      });\n      this.setState({\n        selectedFilterCategories: new_list,\n        tableKey: this.state.tableKey + 1\n      });\n    }\n  }\n\n  //return tablelist object\n  //If a category exists in the selectedFilterCategories list, then push it into a variable called selectedCategories\n  //Exception for vision and pressure, have both left and right addded to the category.\n  getTables() {\n\n    var nullTable =\n      <Col style={styles.titleText}>\n        <div> You Have Not Selected A Patent  </div>\n      </Col>\n\n    if (!this.state.loaded || !this.state.patientInfo) {\n      return [nullTable, null];\n    }\n\n    let selectedCategories = [];\n    for (let i = 0; i < this.state.filterCategories.length; i++) {\n      let category = this.state.filterCategories[i];\n      if (this.state.selectedFilterCategories.indexOf(category) !== -1) {\n        if (category === \"Vision\" || category === \"Pressure\") {\n          selectedCategories.push(\"Left \" + category);\n          selectedCategories.push(\"Right \" + category);\n        } else {\n          selectedCategories.push(category);\n        }\n      }\n    }\n\n    let patientInfo = this.state.patientInfo;\n    let tableData = [];\n\n    for (let date in patientInfo) {\n      let data = patientInfo[date];\n      let tempDateData = [];\n      let isEmpty = true;\n      if (selectedCategories.indexOf(\"Date\") !== -1) {\n        tempDateData = [\n          {\n            type: \"string\",\n            text: date\n          }\n        ];\n      }\n      for (let ii = 1; ii < selectedCategories.length; ii++) {\n        let category = selectedCategories[ii];\n        let value = {\n          type: \"string\",\n          text: \"\"\n        };\n        let tempValue = data[category];\n        if (!tempValue) {\n          tempDateData.push(value);\n        } else {\n          isEmpty = false;\n          let text = [];\n          if (category === \"Date\") {\n            continue;\n          } else if (category === \"Labs\") {\n            for (let labName in tempValue) {\n              let labValue = tempValue[labName];\n              if (labName && labValue) {\n                text.push(labName + \": \" + labValue);\n                text.push(<br />);\n              } else if (labName) {\n                text.push(labName + \": undefined\");\n                text.push(<br />);\n              }\n            }\n          } else {\n            text = tempValue;\n          }\n          value[\"text\"] = text;\n          tempDateData.push(value);\n        }\n      }\n      if (!isEmpty) {\n        tableData.push(tempDateData);\n      }\n    }\n    tableData.sort((a, b) => compareDates(b[0].text, a[0].text));\n\n    var tempTableData = []\n    for (var i = (this.state.paginationNumber - 1) * 5; i < Math.min((this.state.paginationNumber) * 5,tableData.length); i++) {\n      tempTableData.push(tableData[i])\n    }\n    return [\n      <TableList\n        key={this.state.tableKey}\n        columns={selectedCategories}\n        rows={tempTableData}\n      ></TableList>,\n      this.getSummaryTable(tableData[0])\n    ];\n  }\n\n  //used in the getTable() function\n  //returns TableList object\n  getSummaryTable(patientData) {\n    if (!(patientData && patientData[0])) {\n      return null;\n    }\n\n    const selectedCategories = [\n      \"Date\",\n      \"Eye Diagnosis\",\n      \"Systemic Diagnosis\",\n      \"Age\",\n      \"Ethnicity\",\n      \"Image Procedure Type\",\n      \"Labs\",\n      \"Medication Generic Name\",\n      \"Medication Therapuetic Name\",\n      \"Left Vision\",\n      \"Right Vision\",\n      \"Left Pressure\",\n      \"Right Pressure\",\n      \"Exam ID\"\n    ];\n\n    let date = patientData[0].text;\n    patientData = this.state.patientInfo[date];\n\n    let patientInfo = this.props.pageStatus.PatientHistoryPage.patientInfo;\n    patientData[\"Ethnicity\"] = patientInfo.ethnicity;\n    patientData[\"Image Procedure Type\"] = patientInfo.image_type;\n    patientData[\"Age\"] = patientInfo.age;\n    patientData[\"Date\"] = date;\n\n    let tableData = [];\n    let tempDateData = [];\n\n    for (let i = 0; i < selectedCategories.length; i++) {\n      let category = selectedCategories[i];\n      let value = {\n        type: \"string\",\n        text: patientData[category]\n      };\n      let tempText = [];\n      if (typeof patientData[category] === \"object\") {\n        for (let j = 0; j < patientData[category].length; j++) {\n          tempText.push(patientData[category][j]);\n          tempText.push(<br />);\n        }\n        value[\"text\"] = tempText;\n      }\n      tempDateData.push(value);\n    }\n    tableData = [tempDateData];\n    return (\n      <TableList columns={selectedCategories} rows={tableData}></TableList>\n    );\n  }\n\n  //Change page to patients page, with additionalInfo serving as the \"memory\" to retain entered filter information\n  backButtonPressed() {\n    let newState = {\n      page: \"PatientsPage\"\n    };\n    this.props.changePage(newState);\n  }\n\n  //To be filled after images are set up\n  imagesButtonPressed() {\n    let tempPageStatus = this.props.pageStatus;\n    tempPageStatus[\"PatientImagesPage\"] = {\n      patientID: this.state.patientID\n    };\n    let newState = {\n      page: \"PatientImagesPage\",\n      pageStatus: tempPageStatus\n    };\n    this.props.changePage(newState);\n  }\n\n  paginationClicked(e) {\n    this.setState({\n      paginationNumber: e.target.title\n    })\n  }\n\n  getPagination() {\n    var pagination = []\n    if (!this.state.patientInfo) {\n      return null\n    }\n    console.log(\"LOOK HERE\",Object.keys(this.state.patientInfo).length)\n    for (var number = 0; number < Object.keys(this.state.patientInfo).length / 5; number++) {\n      if (number+1 === this.state.paginationNumber) {\n        pagination.push(\n          <Pagination.Item title={number + 1} style={styles.paginationActive} onClick={e => this.paginationClicked(e)}>\n            {number + 1}\n          </Pagination.Item>,\n        );\n      }\n      else {\n      pagination.push(\n        <Pagination.Item title={number + 1} onClick={e => this.paginationClicked(e)}>\n          {number + 1}\n        </Pagination.Item>,\n      );\n      }\n    }\n    return <Pagination style={styles.paginationStyle}>{pagination}</Pagination>\n  }\n\n  //render is what shows on the webpage\n  render() {\n    let all_filters = this.getFilters();\n    let tables = this.getTables();\n    let table = null;\n    let summaryTable = null;\n    var pagination = this.getPagination();\n    if (tables) {\n      table = tables[0];\n      summaryTable = tables[1];\n    }\n    return (\n      <div>\n        <Grid fluid>\n          <Row style={styles.titleStyle}>\n            <Col lg={12} sm={8} style={styles.titleText}>\n              <div>Individual Patient History ID: {this.state.patientID}</div>\n            </Col>\n          </Row>\n          <Row style={styles.summaryStyle}>\n            <Col style={styles.summaryText}>\n              <div style={styles.underMainStyle}>\n                <DropdownButton style={styles.buttonContainer} title=\"TAKE AN ACTION\">\n                  <CustomButton\n                    style={styles.buttonUpperBack}\n                    onClick={() => this.backButtonPressed()}\n                  >\n                    BACK TO PATIENTS PAGE\n                    </CustomButton>\n                  <CustomButton\n                    style={styles.buttonUpperImages}\n                    onClick={() => this.imagesButtonPressed()}\n                  >\n                    SEE ALL PATIENTS IMAGES\n                    </CustomButton>\n                </DropdownButton>\n              </div>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={3}>\n              <Row>\n                <CustomButton style={styles.buttonDivShow}>\n                  {\" \"}\n                  Shown{\" \"}\n                </CustomButton>\n                <CustomButton style={styles.buttonDivHide}>\n                  {\" \"}\n                  Hidden{\" \"}\n                </CustomButton>\n              </Row>\n              <Row>{all_filters}</Row>\n            </Col>\n            <Col sm={9}>\n              <Grid fluid>\n                <Row style={styles.underTitleStyle}>{summaryTable}</Row>\n                <Row>\n                  <div style={styles.mainDivStyle}>\n                  {table}\n                  {pagination}\n                  </div>\n                </Row>\n              </Grid>\n            </Col>\n          </Row>\n        </Grid>\n      </div>\n    );\n  }\n}\n\nexport default PatientHistoryPage;\n\nconst styles = {\n  titleStyle: {\n    height: \"10vh\",\n    \"margin-bottom\": \"2vh\"\n  },\n  titleText: {\n    display: \"flex\",\n    \"align-items\": \"center\",\n    \"justify-content\": \"center\",\n    \"font-weight\": \"bold\",\n    \"font-size\": \"30px\"\n  },\n  buttonDiv: {\n    width: \"100%\",\n    margin: \"1vh\",\n    \"background-color\": \"white\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  buttonDivPressed: {\n    width: \"100%\",\n    margin: \"1vh\",\n    \"background-color\": \"#78deec\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  buttonDivHide: {\n    width: \"45%\",\n    \"margin-top\": \"1vh\",\n    \"margin-bottom\": \"1vh\",\n    \"margin-left\": \"2vh\",\n    \"background-color\": \"white\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  buttonDivShow: {\n    width: \"45%\",\n    margin: \"1vh\",\n    \"background-color\": \"#78deec\",\n    color: \"black\",\n    border: \"solid 2px black\"\n  },\n  mainDivStyle: {\n    \"max-height\": \"90vh\",\n    \"max-width\": \"120vh\",\n    overflow: \"scroll\"\n  },\n  underTitleStyle: {\n    \"max-width\": \"120vh\",\n    overflow: \"scroll\",\n    \"margin-top\": \"1vh\",\n  },\n  underMainStyle: {\n    display: \"flex\",\n    \"flex-direction\": \"column\",\n    \"justify-content\": \"flex-end\",\n    \"align-items\": \"flex-end\",\n    \"padding-right\": \"2vh\"\n  },\n  buttonUpperBack: {\n    width: \"40vh\",\n    color: \"black\",\n    border: \"solid 2px black\",\n    \"font-weight\": \"bold\",\n    \"margin-top\": \"1vh\"\n  },\n  buttonContainer: {\n    width: \"40vh\",\n    color: \"black\",\n    border: \"solid 2px black\",\n    \"font-weight\": \"bold\",\n    \"background-color\": \"#eef27c\",\n  },\n  buttonUpperImages: {\n    width: \"40vh\",\n    color: \"black\",\n    border: \"solid 2px black\",\n    \"font-weight\": \"bold\",\n    \"margin-top\": \"1vh\",\n    \"margin-bottom\": \"1vh\"\n  }\n};\n"]},"metadata":{},"sourceType":"module"}